import telebot
from telebot import types
import config
from work import *
import numpy as np
import pandas as pd

API_TOKEN = config.Token
bot = telebot.TeleBot(API_TOKEN)
flight = []
flight_read = None
head_flight = ['date', 'type_flight', 'n_exe', 't_of_d', 'fl_hours', 'count_fl', 'score', 'num_rec']


@bot.message_handler(commands=['start'])
def start_message(message):
    bot.send_message(message.chat.id, f'''
    –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é, {message.from_user.first_name}!
    –Ø flight_accounting_bot.
    –ü–æ–º–æ–≥—É —Ç–µ–±–µ –≤–µ—Å—Ç–∏ —É—á–µ—Ç –ø–æ–ª–µ—Ç–æ–≤.
    –í—ã–±–µ—Ä–∏ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π –ø—É–Ω–∫—Ç –º–µ–Ω—é:
    /load - –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ —Ñ–∞–π–ª–∞
    /add - –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª–µ—Ç–µ
    /data - –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–≤–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    /select - –≤—ã–±–æ—Ä–∫–∏ –∏–∑ –±–∞–∑—ã
    ''')
    # /data - –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –º–µ–Ω—é —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –≤—ã–±–æ—Ä–∫–∏ –ø–æ –∫–Ω–æ–ø–∫–∞–º
# –¥–æ–±–∞–≤–∏—Ç—å –ø–æ—Ç–æ–º –∫–Ω–æ–ø–æ—á–Ω–æ–µ –º–µ–Ω—é
# –ø—Ä–∏ –≤–≤–æ–¥–µ –∑–Ω–∞—á–µ–Ω–∏–π –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ñ–æ—Ä–º–∞—Ç–∞ —á–µ—Ä–µ–∑ —Ä–µ–≥—É–ª—è—Ä–∫—É

def flight_load():
    global flight_read
    flight_read = pd.read_csv(
    'flight.csv', 
    delimiter=',', 
    # –ø–µ—Ä–µ–¥–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤ dataframe
    names = head_flight)
    print(flight_read)
    # print('—Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö', type(flight_read))


@bot.message_handler(commands=['load'])
def load_message(message):
    try:
        flight_load()
        bot.send_message(message.chat.id, text='''–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã.
        –í—ã–±–µ—Ä–∏ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π –ø—É–Ω–∫—Ç –º–µ–Ω—é:
        /add - –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª–µ—Ç–µ
        /data - –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–≤–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        /select - –≤—ã–±–æ—Ä–∫–∏ –∏–∑ –±–∞–∑—ã
        ''')
    except:
        bot.send_message(message.chat.id, text='''–î–∞–Ω–Ω—ã–µ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã.
        –ñ–º–∏, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å:
        /add - –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª–µ—Ç–µ''')
     

@bot.message_handler(commands=['add'])
def add_message(message):
    flight.clear()
    msg = bot.reply_to(
        message, '–í–≤–µ–¥–∏ –¥–∞—Ç—É –ø–æ–ª–µ—Ç–∞ –≤ –ø–æ–ª–µ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π üëá –≤ —Ñ–æ—Ä–º–∞—Ç–µ xx.xx.xxxx')
    # —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º —Å–ª–µ–¥.—Å–æ–±—ã—Ç–∏–µ –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ –¥–∞—Ç—ã
    bot.register_next_step_handler(msg, date_input)

# –∑–¥–µ—Å—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –ø–æ–ª—è –∏ –ø–æ–∫–∞ –º–æ–∂–Ω–æ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ - —Ä–∞–∑–æ—Ä–∞—Ç—å—Å—è —Å csv


def date_input(message):
    global flight
    try:
        flight_date = message.text
        flight.append(flight_date)
        print(flight)
        # –¥–æ–±–∞–≤–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã —á–µ—Ä–µ–∑ –∏–Ω–ª–∞–π–Ω –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É - 3 –∑–Ω–∞—á
        # –º–æ–∂–µ—Ç –ª—É—á—à–µ —Å–¥–µ–ª–∞—Ç—å –æ–±—ã—á–Ω—É—é? –¥–ª—è —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ —Å—Ä–∞–∑—É –≤ –ø–æ–ª–µ
        keyboard = types.InlineKeyboardMarkup(row_width=1)
        b1 = types.InlineKeyboardButton(
            text='–î–µ—Å–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ–π—Å–∫ –±–æ–µ–≤–æ–π —Ç–µ—Ö–Ω–∏–∫–∏', callback_data='–î–µ—Å–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ')
        b2 = types.InlineKeyboardButton(
            text='–ü–µ—Ä–µ–≤–æ–∑–∫–∞ –±–æ–µ–≤–æ–π —Ç–µ—Ö–Ω–∏–∫–∏ –∏ –≥—Ä—É–∑–æ–≤', callback_data='–ü–µ—Ä–µ–≤–æ–∑–∫–∞')
        b3 = types.InlineKeyboardButton(
            text='–ü–æ–ª–µ—Ç—ã –Ω–∞ –°–û–ñ', callback_data='–°–û–ñ')
        keyboard.add(b1, b2, b3)
        bot.reply_to(message, '–í—ã–±–µ—Ä–∏—Ç–µ –í–∏–¥ –±–æ–µ–≤–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è üëá',
                     reply_markup=keyboard)

    except Exception as e:
        bot.reply_to(message, 'oooops')


@bot.callback_query_handler(func=lambda call: True)
def user_choice(call):
    global flight
    text = call.data
    bot.answer_callback_query(call.id, "–ü—Ä–∏–Ω—è—Ç–æ")
    flight.append(text)
    print(flight)
    msg = bot.edit_message_text(chat_id=call.message.chat.id,
                                message_id=call.message.message_id, text='–í–≤–µ–¥–∏ –Ω–æ–º–µ—Ä —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è')
    bot.register_next_step_handler(msg, exe_input)


def exe_input(message):
    global flight
    try:
        num_exe = message.text
        flight.append(num_exe)
        print(flight)
        # –≤—Å–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è, –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è –Ω–∞ 2 –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ –Ω–æ—á–Ω—ã–º, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫ –¥–Ω–µ–≤–Ω—ã–º
        if num_exe[0] == '2':
            flight.append('–ù')
        else:
            flight.append('–î')
        msg = bot.reply_to(
            message, '–û—Ç–ª–∏—á–Ω–æ! –ñ–¥—É –≤—Ä–µ–º—è –ø–æ–ª–µ—Ç–∞ üëá –≤ —Ñ–æ—Ä–º–∞—Ç–µ —á—á:–º–º\n–ù–∞–ø—Ä–∏–º–µ—Ä, 2:45; 3:00; 0:20 –∏ —Ç.–¥.')
        bot.register_next_step_handler(msg, time_input)
    except Exception as e:
        bot.reply_to(message, 'oooops')


def time_input(message):
    global flight
    try:
        # –¥–æ–±–∞–≤–ª—è—é –∫ –∑–Ω–∞—á–µ–Ω–∏—é —Å–µ–∫—É–Ω–¥—ã –¥–ª—è —Ç–∏–ø–∞ timedelta64[ns] -  hh:mm:ss format
        flight_time = f'{message.text}:00'
        flight.append(flight_time)
        print(flight)
        msg = bot.reply_to(
            message, '–û–∫! –°–∫–æ–ª—å–∫–æ –±—ã–ª–æ –ø–æ–ª–µ—Ç–æ–≤?')
        bot.register_next_step_handler(msg, count_input)
    except Exception as e:
        bot.reply_to(message, 'oooops')


def count_input(message):
    global flight
    try:
        flight_count = message.text
        if not flight_count.isdigit():
            msg = bot.reply_to(
                message, '–ù—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å —Ü–∏—Ñ—Ä—É. –í–≤–µ–¥–∏ —á–∏—Å–ª–æ –ø–æ–ª–µ—Ç–æ–≤:')
            bot.register_next_step_handler(msg, count_input)
            return
        flight.append(flight_count)
        print(flight)
        msg = bot.reply_to(
            message, '–ü—Ä–∏–Ω—è–ª! –¢–µ–ø–µ—Ä—å –≤–≤–µ–¥–∏ –æ—Ü–µ–Ω–∫—É –∑–∞ –±–æ–µ–≤–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:')
        bot.register_next_step_handler(msg, eval_input)
    except Exception as e:
        bot.reply_to(message, 'oooops')


def eval_input(message):
    global flight
    try:
        flight_eval = message.text
        if not flight_eval.isdigit():
            msg = bot.reply_to(message, '–ù—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å —Ü–∏—Ñ—Ä—É. –í–≤–µ–¥–∏ –æ—Ü–µ–Ω–∫—É:')
            bot.register_next_step_handler(msg, eval_input)
            return
        flight.append(flight_eval)
        print(flight)
        msg = bot.reply_to(
            message, '–°—É–ø–µ—Ä! –£–∫–∞–∂–∏ –Ω–æ–º–µ—Ä –∫–Ω–∏–∂–∫–∏/–Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã\n–Ω–∞–ø—Ä–∏–º–µ—Ä, 2/56')
        bot.register_next_step_handler(msg, num_str)
    except Exception as e:
        bot.reply_to(message, 'oooops')



def num_str(message):
    global flight
    try:
        flight_num = message.text
        flight.append(flight_num)
        print(flight)
        markup = types.ReplyKeyboardMarkup(
            one_time_keyboard=True, resize_keyboard=True)
        markup.add('–û–∫', '–û—Ç–º–µ–Ω–∞')
        msg = bot.reply_to(
            message, f'–ü—Ä–æ–≤–µ—Ä—å –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏ –≤–≤–µ–¥–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –ø–æ–ª–µ—Ç—É{str_list(flight)}', reply_markup=markup)
        bot.register_next_step_handler(msg, process_confirm)
    except Exception as e:
        bot.reply_to(message, 'oooops')


def process_confirm(message):
    global flight
    try:
        confirm = message.text
        if confirm == '–û–∫':
            # –≤—ã–≤–µ—Å—Ç–∏ –∫–æ–º–∞–Ω–¥—ã –∏–ª–∏ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ñ-—Ü–∏—é –∏ –≤—ã–∑—ã–≤–∞—Ç—å –µ–µ –ø–æ—Å–ª–µ —Å–æ–±—ã—Ç–∏—è
            bot.reply_to(message, '''–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã.
            –í—ã–±–µ—Ä–∏ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π –ø—É–Ω–∫—Ç –º–µ–Ω—é:
            /add - –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª–µ—Ç–µ
            /data - –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–≤–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            /select - –≤—ã–±–æ—Ä–∫–∏ –∏–∑ –±–∞–∑—ã''')
            # –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ —Ñ–∞–π–ª
            with open('flight.csv', 'a', encoding="utf8") as file:
                file.write(f"{','.join(flight)}\n")

        elif confirm == '–û—Ç–º–µ–Ω–∞':
            bot.reply_to(message, '''–î–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã.
            –í—ã–±–µ—Ä–∏ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π –ø—É–Ω–∫—Ç –º–µ–Ω—é:
            /add - –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª–µ—Ç–µ
            /data - –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–≤–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            /select - –≤—ã–±–æ—Ä–∫–∏ –∏–∑ –±–∞–∑—ã
        ''')
            flight.clear()
            print(f'–°–ø–∏—Å–æ–∫ –æ—á–∏—â–µ–Ω {flight}')
        else:
            raise Exception()
    except Exception as e:
        bot.reply_to(message, 'oooops')


@bot.message_handler(commands=['data'])
def data_message(message):
    # –æ–±–Ω–æ–≤–ª—è–µ–º DataFrame
    flight_load()    
    bot.send_message(message.chat.id, text=flight_read.to_string())
    bot.send_message(message.chat.id, text=flight_read.to_markdown(tablefmt="grid"))
    print(flight_read.to_markdown())
    print(flight_read.index)
    print(flight_read.info())
    # —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∑–¥–µ—Å—å —Å–≤–æ–¥ –≤ —Ä–∞–∑—Ä–µ–∑–µ –Ω—É–∂–Ω—ã—Ö –≥—Ä—É–ø–ø–∏—Ä–æ–≤–æ–∫ - —Ç–æ–ª—å–∫–æ –æ–±—â–∏–µ –¥–∞–Ω–Ω—ã–µ
#  .to_markdown() - –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫—Ä–∞—Å–∏–≤–æ, –º–æ–∂–µ—Ç —Ñ–∞–π–ª–æ–º?
# –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö - —ç—Ç–æ –º–æ–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –≤ —Ä–∞–±.–º–æ–¥—É–ª—å
    # flight_read['fl_hours'] = flight_read['fl_hours'].astype("datetime64[ns]") - —ç—Ç–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –¥–∞—Ç
    # —á—Ç–æ–± —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å –≤ –ø–µ—Ä–∏–æ–¥–µ

    # –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è - –Ω—É–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å –≤ —Å—Ç—Ä–æ–∫–µ —Ñ–æ—Ä–º–∞—Ç hh:mm:ss format
    flight_read['fl_hours'] = flight_read['fl_hours'].astype("timedelta64[ns]") 
    print('—Å–º–µ–Ω–∞ —Ç–∏–ø–∞\n',flight_read.info())
    tdi = flight_read.fl_hours.sum() #—Å—É–º–º–∞ –Ω–∞–ª–µ—Ç–∞ —á–∞—Å–æ–≤ - —Å—á–∏—Ç–∞–µ—Ç –¥–µ–ª—å—Ç—ã –ø–æ —Å—Ç—Ä–æ–∫–∞–º
    print(tdi) #0 days 07:15:00
    # tdi = tdi /  np.timedelta64(1,  "h") #–ø—ã—Ç–∞—é—Å—å –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤ —á–∞—Å—ã, –ø–æ–ª—É—á–∞—é –≤–µ—Ä–Ω–æ - —Ç–∏–ø –§–ª–æ–∞—Ç
    # print(tdi) #7.25
    # –ø—Ä–æ–±—É—é –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–ª—å–∫–æ —á–∞—Å—ã –∏ –º–∏–Ω—É—Ç—ã –±–µ–∑ –¥–Ω–µ–π
    minutes = tdi.total_seconds()/60
    hours = minutes/60
    print(tdi.total_seconds(),minutes, hours) #26100.0 435.0 7.25

    bot.send_message(message.chat.id, text=f'–í—Ä–µ–º—è –≤—ã–ª–µ—Ç–æ–≤:\n {flight_read.fl_hours}')
    bot.send_message(message.chat.id, text=f'–°—É–º–º–∞ –Ω–∞–ª–µ—Ç–∞: {flight_read.fl_hours.sum()}')
    # –≤ –∏—Ç–æ–≥–µ –º–Ω–µ –Ω—É–∂–µ–Ω –∏–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –≤ —á–∞—Å–∞—Ö - –°—É–º–º–∞ –Ω–∞–ª–µ—Ç–∞ –∫ —á–∞—Å–∞–º: 7.25
    # –≤ —Ä–∞–∑–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞—Ö –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
    bot.send_message(message.chat.id, text=f'–°—É–º–º–∞ –Ω–∞–ª–µ—Ç–∞ –∫ —á–∞—Å–∞–º: {flight_read.fl_hours.sum()/ np.timedelta64(1,  "h")}')
    bot.send_message(message.chat.id, text=f'–°—É–º–º–∞ –≤—ã–ª–µ—Ç–æ–≤: {flight_read.count_fl.sum(numeric_only=True)}')

    # —Ñ–æ—Ä–º–∏—Ä—É—é —Å–≤–æ–¥: –í—Ä–µ–º—è —Å—É—Ç–æ–∫ - –ù–∞–ª–µ—Ç - –∫–æ–ª.–ø–æ–ª–µ—Ç–æ–≤
    # article_read.groupby('source').count()[['user_id']]
    print('–¥–ª—è —Å–≤–æ–¥–∞\n',flight_read.info())
    svod_data = flight_read.groupby(['t_of_d','type_flight']).sum(numeric_only=False)[['fl_hours','count_fl']]
    print(svod_data.to_markdown())
    # print(df.to_markdown(tablefmt="grid"))
    bot.send_message(message.chat.id, text=f'–°–≤–æ–¥ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫:\n {svod_data.to_markdown(tablefmt="grid")}')


@bot.message_handler(commands=['select'])
def selections_message(message):
    # –∞ –º–æ–∂–Ω–æ –≤—Å–µ –≤—ã–±–æ—Ä–∫–∏ –Ω–µ –Ω–∞–ø—Ä—è–º—É—é –≤—ã—Å—ã–ª–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ–º, –∞ –ø–æ–º–µ—â–∞—Ç—å –ª–∏–±–æ –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª, –ª–∏–±–æ –≤ –≠–∫—Å–µ–ª—å
    # V–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é to_excel() –¥–ª—è –∑–∞–ø–∏—Å–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤ —Ñ–∞–π–ª. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äî —ç—Ç–æ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É:
    # df.to_excel('./teams.xlsx')
    # frame.to_excel('data2.xlsx')
    # –æ–±–Ω–æ–≤–ª—è–µ–º DataFrame
    flight_load()    
    # –≤—ã–±–æ—Ä–∫–∏ –ø–æ –ø–æ–ª—è–º/–∑–Ω–∞—á–µ–Ω–∏—è–º - –ø—Ä–æ–±—É—é –≤–∞—Ä–∏–∞–Ω—Ç—ã - –ø–æ—Ç–æ–º –∏—Ö —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –ø–æ–¥ –∫–Ω–æ–ø–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º —Ç–µ–∫—Å—Ç–∞ –≤—ã–≤–æ–¥–∏—Ç—å
    # –ø–æ —Å–≤–æ–∏–º —Ñ-—Ü–∏—è–º
    fn = flight_read["type_flight"].map(lambda x: x == "–î–µ—Å–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ")
    # –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø–æ –¥—Ä. –ø–æ–ª—è–º - –Ω–æ –∑–¥–µ—Å—å –Ω–µ—Ç –∏—Ç–æ–≥–æ–≤
    print(flight_read[fn])
    bot.send_message(message.chat.id, text=flight_read[fn].to_markdown())
    # –Ω–æ—á–Ω—ã–µ/–¥–Ω–µ–≤–Ω—ã–µ
    fn = flight_read["t_of_d"].map(lambda x: x == "–î")
    print('–¥–Ω–µ–≤–Ω—ã–µ', flight_read[fn])
    bot.send_message(message.chat.id, text=f'–î–Ω–µ–≤–Ω—ã–µ –ø–æ–ª–µ—Ç—ã \n{flight_read[fn].to_markdown()}')
    # –Ω–æ—á–Ω—ã–µ
    fn = flight_read["t_of_d"].map(lambda x: x == "–ù")
    print('–Ω–æ—á–Ω—ã–µ', flight_read[fn])
    bot.send_message(message.chat.id, text=f'–ù–æ—á–Ω—ã–µ –ø–æ–ª–µ—Ç—ã \n{flight_read[fn].to_markdown()}')

# –≤–æ–ø—Ä–æ—Å –ø–æ —É–¥–∞–ª–µ–Ω–∏—é - —Å—Ç–æ–∏—Ç –ª–∏ –¥–æ–±–∞–≤–ª—è—Ç—å?
# –µ—Å–ª–∏ –¥–∞ - —Ç–æ —É–¥–∞–ª—è—Ç—å –∏–∑ —Ñ—Ä–µ–π–º–∞, –∞ –ø–æ—Ç–æ–º –µ–≥–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –≤ —Ñ–∞–π–ª? - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å!
# —Å–µ–π—á–∞—Å —É –º–µ–Ω—è –≤ –∫–∞–∂–¥–æ–π –∫–æ–º–∞–Ω–¥–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –æ–Ω –∏–∑ —Ñ–∞–π–ª–∞, –Ω–æ–≤–æ–µ —Ç–∞–∫–∂–µ —Å—Ä–∞–∑—É –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —Ñ–∞–π–ª
# –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º –º–æ–∂–Ω–æ –≤—ã—Å–ª–∞—Ç—å —é–∑–µ—Ä—É —ç–∫—Å–µ–ª—å —Ñ–∞–π–ª —Å –ø–æ–ª–Ω—ã–º –ø–µ—Ä–µ—á–Ω–µ–º, –æ–Ω –≤—ã–±–∏—Ä–µ—Ç –∏–Ω–¥–µ–∫—Å(—ã) –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è

bot.polling()
